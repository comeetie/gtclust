scale_color_distiller("Speed (km/h)",palette="RdYlGn",direction = 1)+
theme(legend.position="left")+
ggtitle("Shenzen clustering results","8h30-8h45")
plot(hc_res$Ll)
plot(geocutree(hc_res,7))
plot(hc_res)
plot(geocutree(hc_res,4))
plot(hc_res)
nb = sf::st_relate(links.sf,links.sf, pattern = "F***T****")
plot(geocutree(hc_res,4))
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_bayes_dgmm())
k_max= 100
N=nrow(links)
pr=sptree_prior(hc_res,k_max)
pr$Cnk=lgamma(N)-lgamma(1:k_max)-lgamma(2013-2:(k_max+1))
pr$ptot=pr$inter+pr$intra-pr$intra[1]#-pr$Cnk-lgamma(1:k_max+1)
pr$Ll=hc_res$Ll[N:(N-k_max+1)]
pr$intra_comp=hc_res$PriorIntra[N:(N-k_max+1)]
pr$inter_comp=hc_res$PriorInter[N:(N-k_max+1)]
pr
library(gtclust)
data("modesshare.idf")
library(gtclust)
data("modesshare.idf")
library(dplyr)
library(sf)
links=st_intersects(modesshare.idf,modesshare.idf)
nb=st_intersects(modesshare.idf,modesshare.idf)
nb=as.list(nb)
xy=modesshare.idf |> st_centroid() |> st_coordinates()
Lp = do.call(rbind,lapply(1:length(nb),\(l){
if(length(nb[[l]])>1){
cbind(xy[l,1],xy[l,2],xy[nb[[l]],])
}else{
c(xy[l,1],xy[l,2],xy[nb[[l]],])
}
}))
links_geom = st_sfc(lapply(1:nrow(Lp),\(l){ st_linestring(rbind(Lp[l,1:2],Lp[l,3:4]))}),crs=st_crs(links.sf))
library(ggplot2)
plot(links_geom)
nodes_geom = modesshare.idf |> st_centroid() |> st_geometry()
ggplot()+geom_sf(data=links_geom,size=0.3)
ggplot()+geom_sf(data=links_geom,size=0.3)+theme_void()
ggplot()+geom_sf(data=links_geom,size=0.1)+theme_void()
st_bbox(nodes_geom)
ggplot()+geom_sf(data=links_geom,size=0.1)+cood_sf(xlim=c(650000,700000),ylim=c(6820000,6860000))+theme_void()
ggplot()+geom_sf(data=links_geom,size=0.1)+coord_sf(xlim=c(650000,700000),ylim=c(6820000,6860000))+theme_void()
ggplot()+geom_sf(data=links_geom,size=0.1)+coord_sf(xlim=c(630000,700000),ylim=c(6820000,6860000))+theme_void()
ggplot()+geom_sf(data=links_geom,size=0.1)+coord_sf(xlim=c(630000,680000),ylim=c(6820000,6860000))+theme_void()
ggplot()+geom_sf(data=links_geom,size=0.1)+coord_sf(xlim=c(630000,675000),ylim=c(6820000,6860000))+theme_void()
ggplot()+geom_sf(data=links_geom,size=0.1)+coord_sf(xlim=c(630000,675000),ylim=c(6850000,6900000))+theme_void()
ggplot()+geom_sf(data=links_geom,size=0.1)+coord_sf(xlim=c(640000,670000),ylim=c(6870000,6890000))+theme_void()
ggplot()+geom_sf(data=links_geom,size=0.1)+geom_sf(data=nodes_geom,size=0.1)+coord_sf(xlim=c(640000,670000),ylim=c(6870000,6890000))+theme_void()
nodes_geom = modesshare.idf |> st_centroid()
ggplot()+geom_sf(data=links_geom,size=0.1)+geom_sf(data=nodes_geom,size=0.1)+coord_sf(xlim=c(640000,670000),ylim=c(6870000,6890000))+theme_void()
links_geom = st_sfc(lapply(1:nrow(Lp),\(l){ st_linestring(rbind(Lp[l,1:2],Lp[l,3:4]))}),crs=st_crs(modesshare.idf))
nodes_geom = modesshare.idf |> st_centroid()
ggplot()+geom_sf(data=links_geom,size=0.1)+geom_sf(data=nodes_geom,size=0.1)+coord_sf(xlim=c(640000,670000),ylim=c(6870000,6890000))+theme_void()
ggplot()+geom_sf(data=links_geom,size=0.1)+geom_sf(data=nodes_geom,size=0.5)+coord_sf(xlim=c(640000,670000),ylim=c(6870000,6890000))+theme_void()
ggplot()+geom_sf(data=modesshare.idf,size=0.5)+
geom_sf(data=links_geom,size=0.1)+
geom_sf(data=nodes_geom,size=0.5)+
coord_sf(xlim=c(640000,670000),ylim=c(6870000,6890000))+
theme_void()
ggplot()+geom_sf(data=modesshare.idf,size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.1)+
geom_sf(data=nodes_geom,size=0.5)+
coord_sf(xlim=c(640000,670000),ylim=c(6870000,6890000))+
theme_void()
ggplot()+geom_sf(data=modesshare.idf,size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=0.5)+
coord_sf(xlim=c(640000,670000),ylim=c(6870000,6890000))+
theme_void()
ggplot()+geom_sf(data=modesshare.idf,size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=0.5)+
coord_sf(xlim=c(650000,670000),ylim=c(6880000,6890000))+
theme_void()
ggplot()+geom_sf(data=modesshare.idf,size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=0.8)+
coord_sf(xlim=c(650000,670000),ylim=c(6880000,6890000))+
theme_void()
ggplot()+geom_sf(data=modesshare.idf,size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=0.8)+
coord_sf(xlim=c(650000,670000),ylim=c(6880000,6887000))+
theme_void()
ggplot()+geom_sf(data=modesshare.idf,size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=0.8)+
coord_sf(xlim=c(650000,660000),ylim=c(6880000,6887000))+
theme_void()
ggplot()+geom_sf(data=modesshare.idf,size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.2)+
coord_sf(xlim=c(650000,660000),ylim=c(6880000,6887000))+
theme_void()
ggplot()+geom_sf(data=modesshare.idf,size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(650000,660000),ylim=c(6880000,6887000))+
theme_void()
data("modesshare.pts")
modesshare.pts |> filter(DEP=="37")
df = modesshare.pts |> filter(DEP=="37")
xy = sf::st_coordinates(df)[,1:2]
delaunay = RTriangle::triangulate(RTriangle::pslg(xy))
nb=rep(list(c()),nrow(df))
for (il in 1:nrow(delaunay$E)){
r = delaunay$E[il,]
nb[[r[1]]]=c(nb[[r[1]]],r[2])
nb[[r[2]]]=c(nb[[r[2]]],r[1])
}
Lp = do.call(rbind,lapply(1:length(nb),\(l){
if(length(nb[[l]])>1){
cbind(xy[l,1],xy[l,2],xy[nb[[l]],])
}else{
c(xy[l,1],xy[l,2],xy[nb[[l]],])
}
}))
links_geom = st_sfc(lapply(1:nrow(Lp),\(l){ st_linestring(rbind(Lp[l,1:2],Lp[l,3:4]))}),crs=st_crs(modesshare.idf))
nodes_geom = modesshare.idf |> st_centroid()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(650000,660000),ylim=c(6880000,6887000))+
theme_void()
links_geom = st_sfc(lapply(1:nrow(Lp),\(l){ st_linestring(rbind(Lp[l,1:2],Lp[l,3:4]))}),crs=st_crs(modesshare.pts))
nodes_geom = modesshare.idf |> st_centroid()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(650000,660000),ylim=c(6880000,6887000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
theme_void()
df = modesshare.pts |> filter(DEP=="37")
xy = sf::st_coordinates(df)[,1:2]
delaunay = RTriangle::triangulate(RTriangle::pslg(xy))
nb=rep(list(c()),nrow(df))
for (il in 1:nrow(delaunay$E)){
r = delaunay$E[il,]
nb[[r[1]]]=c(nb[[r[1]]],r[2])
nb[[r[2]]]=c(nb[[r[2]]],r[1])
}
Lp = do.call(rbind,lapply(1:length(nb),\(l){
if(length(nb[[l]])>1){
cbind(xy[l,1],xy[l,2],xy[nb[[l]],])
}else{
c(xy[l,1],xy[l,2],xy[nb[[l]],])
}
}))
links_geom = st_sfc(lapply(1:nrow(Lp),\(l){ st_linestring(rbind(Lp[l,1:2],Lp[l,3:4]))}),crs=st_crs(modesshare.pts))
nodes_geom = df |> st_centroid()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
theme_void()
st_bbox(df)
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(479000,565000),ylim=c(6880000,6887000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(479000,565000),ylim=c(6670000,6700000))+
theme_void()
6887000-6880000
650000-660000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(479000,479000+10000),ylim=c(6670000,6700000))+
theme_void()
xmin = 481000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(6670000,6700000))+
theme_void()
st_bbox(df)
xmin = 481000
ymin = 6680000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+20000),ylim=c(ymin,ymin+14000))+
theme_void()
xmin = 482000
ymin = 6680000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+20000),ylim=c(ymin,ymin+14000))+
theme_void()
xmin = 484000
ymin = 6680000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+20000),ylim=c(ymin,ymin+14000))+
theme_void()
xmin = 485000
ymin = 6680000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+20000),ylim=c(ymin,ymin+14000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+30000),ylim=c(ymin,ymin+21000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
geom_sf(data=st_voronoi(nodes_geom),size=0.2,color="#555555",fill="#ffffff")+
coord_sf(xlim=c(xmin,xmin+30000),ylim=c(ymin,ymin+21000))+
theme_void()
ggplot()+
geom_sf(data=st_voronoi(nodes_geom),size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+30000),ylim=c(ymin,ymin+21000))+
theme_void()
ggplot()+
geom_sf(data=st_voronoi(nodes_geom),size=0.2,color="#555555",fill="#ffffff")
ggplot()+
geom_sf(data=st_voronoi(st_union(nodes_geom)),size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+30000),ylim=c(ymin,ymin+21000))+
theme_void()
xmin = 487000
ymin = 6680000
ggplot()+
geom_sf(data=st_voronoi(st_union(nodes_geom)),size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+30000),ylim=c(ymin,ymin+21000))+
theme_void()
xmin = 490000
ymin = 6680000
ggplot()+
geom_sf(data=st_voronoi(st_union(nodes_geom)),size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+30000),ylim=c(ymin,ymin+21000))+
theme_void()
data("shenzen")
nb = sf::st_relate(shenzen,shenzen, pattern = "F***T****")
class(nb)="list"
xy = shenzen |> st_centroid()
Lp = do.call(rbind,lapply(1:length(nb),\(l){
if(length(nb[[l]])>1){
cbind(xy[l,1],xy[l,2],xy[nb[[l]],])
}else{
c(xy[l,1],xy[l,2],xy[nb[[l]],])
}
}))
xy = shenzen |> st_centroid() |> st_coordinates()
Lp = do.call(rbind,lapply(1:length(nb),\(l){
if(length(nb[[l]])>1){
cbind(xy[l,1],xy[l,2],xy[nb[[l]],])
}else{
c(xy[l,1],xy[l,2],xy[nb[[l]],])
}
}))
links_geom = st_sfc(lapply(1:nrow(Lp),\(l){ st_linestring(rbind(Lp[l,1:2],Lp[l,3:4]))}),crs=st_crs(modesshare.pts))
nodes_geom = shenzen |> st_centroid()
st_bbox(nodes_geom)
xmin = 2493000
ymin = 38550000
ggplot()+
geom_sf(data=st_voronoi(st_union(nodes_geom)),size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+30000),ylim=c(ymin,ymin+21000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+30000),ylim=c(ymin,ymin+21000))+
theme_void()
links_geom = st_sfc(lapply(1:nrow(Lp),\(l){ st_linestring(rbind(Lp[l,1:2],Lp[l,3:4]))}),crs=st_crs(shenzen))
nodes_geom = shenzen |> st_centroid()
st_bbox(nodes_geom)
xmin = 2493000
ymin = 38550000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+30000),ylim=c(ymin,ymin+21000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)
xmin = 2494000
ymin = 38510000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
xmin = 2493000
ymin = 38500000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
xmin = 2491000
ymin = 38500000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
ymin = 38600000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)
xmin = 2491000
ymin = 38502000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
xmin = 2490000
ymin = 38502000
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
ymin = 38502500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=0.5)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=0.3)+
coord_sf(xlim=c(xmin,xmin+10000),ylim=c(ymin,ymin+7000))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=0.3)+
coord_sf(xlim=c(xmin,xmin+5000),ylim=c(ymin,ymin+3500))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+5000),ylim=c(ymin,ymin+3500))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
xmin = 2495000
ymin = 38502500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
0
0
xmin = 2490000
ymin = 38502500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
xmin = 2490200
ymin = 38502500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
xmin = 2490500
ymin = 38502500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=1.5)+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2.5)+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2.5)+
geom_sf(data=nodes_geom,size=2,color="#ffffff")+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2)+
geom_sf(data=nodes_geom,size=1.5,color="#ffffff")+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
library(gtclust)
library(sf)
library(dplyr)
library(ggplot2)
data("modesshare.idf")
nb=st_intersects(modesshare.idf,modesshare.idf)
nb=as.list(nb)
xy=modesshare.idf |> st_centroid() |> st_coordinates()
Lp = do.call(rbind,lapply(1:length(nb),\(l){
if(length(nb[[l]])>1){
cbind(xy[l,1],xy[l,2],xy[nb[[l]],])
}else{
c(xy[l,1],xy[l,2],xy[nb[[l]],])
}
}))
links_geom = st_sfc(lapply(1:nrow(Lp),\(l){ st_linestring(rbind(Lp[l,1:2],Lp[l,3:4]))}),crs=st_crs(modesshare.idf))
nodes_geom = modesshare.idf |> st_centroid()
ggplot()+geom_sf(data=modesshare.idf,size=0.2,color="#555555",fill="#ffffff")+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2)+
geom_sf(data=nodes_geom,size=1.5,color="#ffffff")+
coord_sf(xlim=c(650000,660000),ylim=c(6880000,6880000+7000))+
theme_void()
data("shenzen")
nb = sf::st_relate(shenzen,shenzen, pattern = "F***T****")
class(nb)="list"
xy = shenzen |> st_centroid() |> st_coordinates()
Lp = do.call(rbind,lapply(1:length(nb),\(l){
if(length(nb[[l]])>1){
cbind(xy[l,1],xy[l,2],xy[nb[[l]],])
}else{
c(xy[l,1],xy[l,2],xy[nb[[l]],])
}
}))
links_geom = st_sfc(lapply(1:nrow(Lp),\(l){ st_linestring(rbind(Lp[l,1:2],Lp[l,3:4]))}),crs=st_crs(shenzen))
nodes_geom = shenzen |> st_centroid()
st_bbox(nodes_geom)
xmin = 2490500
ymin = 38502500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2)+
geom_sf(data=nodes_geom,size=1.5,color="#ffffff")+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
ymin = 38507500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2)+
geom_sf(data=nodes_geom,size=1.5,color="#ffffff")+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
ymin = 38506500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2)+
geom_sf(data=nodes_geom,size=1.5,color="#ffffff")+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
xmin = 2491500
ymin = 38506500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2)+
geom_sf(data=nodes_geom,size=1.5,color="#ffffff")+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
xmin = 2492500
ymin = 38506500
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2)+
geom_sf(data=nodes_geom,size=1.5,color="#ffffff")+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
ymin = 38506400
ggplot()+
geom_sf(data=links_geom,size=0.2)+
geom_sf(data=nodes_geom,size=2)+
geom_sf(data=nodes_geom,size=1.5,color="#ffffff")+
coord_sf(xlim=c(xmin,xmin+2500),ylim=c(ymin,ymin+1750))+
theme_void()
