}))
speeds_long = speeds |> mutate(link_id=1:n())|>
tidyr::pivot_longer(-link_id,names_to = "day_h",values_to = "speed")
v=speeds_long |> filter(day_h=="D7T8H30"|day_h=="D7T8H35"|day_h=="D7T8H40") |>
group_by(link_id) |>
summarise(speed=mean(speed,na.rm=TRUE))
v$speed[is.na(v$speed)]=mean(v$speed,na.rm = TRUE)
links.sf$speed=v$speed
sum(is.na(links.sf$speed))
ggplot(links.sf)+geom_sf(aes(color=speed*3.6),size=1.1)+
scale_color_distiller("Speed (km/h)",palette="RdYlGn",direction = 1,limits=c(0,65))+
theme_void()+
theme(legend.position="left")+
ggtitle("Shenzen speed distribution","8h30-8h45")
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_bayes_dgmm())
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_ward())
gtmethod_ward()
gtmethod_ward()$method
library(gtclust)
library(gtclust)
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_ward())
library(gtclust)
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_ward())
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_bayes_dgmm())
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_ward())
plot(hc_res)
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_bayes_dgmm())
plot(hc_res)
gt_res= geocutree(hc_res,81) |> mutate(L=st_length(geometry)) |> arrange(desc(L)) |> head(9)
ggplot(gt_res)+
geom_sf(aes(color=factor(cl)))+
theme_void()+
scale_color_brewer(palette="Set1",guide="none")+
ggtitle("Shenzen clustering results","8h30-8h45")
ggplot(gt_res)+
geom_sf(aes(color=speed*3.6))+
theme_void()+
scale_color_distiller("Speed (km/h)",palette="RdYlGn",direction = 1)+
theme(legend.position="left")+
ggtitle("Shenzen clustering results","8h30-8h45")
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_bayes_dgmm())
gt_res= geocutree(hc_res,30) |> mutate(L=st_length(geometry)) |> arrange(desc(L)) |> head(9)
ggplot(gt_res)+
geom_sf(aes(color=factor(cl)))+
theme_void()+
scale_color_brewer(palette="Set1",guide="none")+
ggtitle("Shenzen clustering results","8h30-8h45")
ggplot(gt_res)+
geom_sf(aes(color=speed*3.6))+
theme_void()+
scale_color_distiller("Speed (km/h)",palette="RdYlGn",direction = 1)+
theme(legend.position="left")+
ggtitle("Shenzen clustering results","8h30-8h45")
ggplot(gt_res)+
geom_sf(aes(color=speed*3.6))+
theme_void()+
scale_color_distiller("Speed (km/h)",palette="RdYlGn",direction = 1)+
theme(legend.position="left")+
ggtitle("Shenzen clustering results","8h30-8h45")
ggplot(gt_res)+
geom_sf(aes(color=factor(cl)))+
theme_void()+
scale_color_brewer(palette="Set1",guide="none")+
ggtitle("Shenzen clustering results","8h30-8h45")
gt_res= geocutree(hc_res,30) |> mutate(L=st_length(geometry)) |> arrange(desc(L))
ggplot(gt_res)+
geom_sf(aes(color=factor(cl)))+
theme_void()+
scale_color_brewer(palette="Set1",guide="none")+
ggtitle("Shenzen clustering results","8h30-8h45")
ggplot(gt_res)+
geom_sf(aes(color=speed*3.6))+
theme_void()+
scale_color_distiller("Speed (km/h)",palette="RdYlGn",direction = 1)+
theme(legend.position="left")+
ggtitle("Shenzen clustering results","8h30-8h45")
plot(hc_res$Ll)
plot(geocutree(hc_res,7))
plot(hc_res)
plot(geocutree(hc_res,4))
plot(hc_res)
nb = sf::st_relate(links.sf,links.sf, pattern = "F***T****")
plot(geocutree(hc_res,4))
hc_res=gtclust_lines(links.sf |> select(speed)|>mutate(speed=log(speed)),gtmethod_bayes_dgmm())
k_max= 100
N=nrow(links)
pr=sptree_prior(hc_res,k_max)
pr$Cnk=lgamma(N)-lgamma(1:k_max)-lgamma(2013-2:(k_max+1))
pr$ptot=pr$inter+pr$intra-pr$intra[1]#-pr$Cnk-lgamma(1:k_max+1)
pr$Ll=hc_res$Ll[N:(N-k_max+1)]
pr$intra_comp=hc_res$PriorIntra[N:(N-k_max+1)]
pr$inter_comp=hc_res$PriorInter[N:(N-k_max+1)]
pr
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
dyn.load("/tmp/RtmpuL8zB0/pkgload2f35bc72a69372/gtclust.so")
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(gtclust)
gtclust:::log_mvn_pdf(cbind(runif(100),runif(100)),c(0,0),diag(rep(1,2)))
gtclust:::log_mvn_pdf(rbind(runif(100),runif(100)),c(0,0),diag(rep(1,2)))
library(gtclust)
gtclust:::glm_fit(cbind(rep(1,100),1:100),rpois(100,5))
gtclust:::glm_fit(cbind(rep(1,1000),1:1000),rpois(1000,5))
exp(1.63)
fit1=gtclust:::glm_fit(cbind(rep(1,1000),1:1000),rpois(1000,5))
fit1=gtclust:::glm_laplace_evidence(cbind(rep(1,1000),1:1000),rpois(1000,5),fit1)
N=500
X= cbind(rep(1,N),1:N)
a = c(1.5,3)
X%*%a
X= cbind(rep(1,N),1:N)
a = c(1.5,0.6)
X%*%a
exp(X%*%a)
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
exp(X%*%a)
rpois(1,eta)
eta = exp(X%*%a)
rpois(1,eta)
rpois(N,eta)
y=rpois(N,eta)
gtclust:::glm_fit(x,Y)
gtclust:::glm_fit(X,y)
fit1 = gtclust:::glm_fit(X,y)
gtclust:::glm_laplace_evidence(X,y,fit1)
N=500
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(15,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit2 = gtclust:::glm_fit(X,y)
N=500
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit2 = gtclust:::glm_fit(X,y)
N=500
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,-0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit3 = gtclust:::glm_fit(X,y)
library(gtclust)
N=500
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit1 = gtclust:::glm_fit(X,y)
N=500
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit2 = gtclust:::glm_fit(X,y)
N=500
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,-0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit3 = gtclust:::glm_fit(X,y)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::delta_merge_post(fit1,fit2)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
N=500
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit1 = gtclust:::glm_fit(X,y)
N=500
X2= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y2=rpois(N,eta)
fit2 = gtclust:::glm_fit(X2,y2)
N=500
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,-0.6)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
fit
fit1
library(gtclust)
N=500
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit1 = gtclust:::glm_fit(X,y)
N=500
X2= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y2=rpois(N,eta)
fit2 = gtclust:::glm_fit(X2,y2)
N=500
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,-0.6)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
gtclust:::glm_laplace_evidence(X,y,fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X,y,fit2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(X,y,fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X,y,fit2))
gtclust:::glm_laplace_evidence(X,y,fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X,y,fit3))
fit13
fit1
fit2
fit3
gtclust:::glm_laplace_evidence(X,y,fit13)
gtclust:::glm_laplace_evidence(X,y,fit12)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X,y,fit2))
gtclust:::glm_laplace_evidence(X,y,fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X,y,fit3))
gtclust:::glm_laplace_evidence(X,y,fit13)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
library(gtclust)
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
lambda=0.01
iL=1/lambda*diag(2)
iL
log(det(iL))
S12=inv(fit1$iH+fit2$iH)
fit1$iH+fit2$iH
S12=solve(fit1$iH+fit2$iH)
S12
log(det(iL-S12))
log(det(S12))
library(gtclust)
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
S12=solve(fit1$H+fit2$H)
log(det(iL-S12))
-log(det(iL-S12))+prod(diag(iL))
-log(det(iL-S12))+log(prod(diag(iL)))
log(det(iL))
2*log(0.01)
library(gtclust)
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
N=500
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,-0.1)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
fit13
library(gtclust)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
fit3
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
library(gtclust)
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
N=5
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit1 = gtclust:::glm_fit(X,y)
N=5
X2= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y2=rpois(N,eta)
fit2 = gtclust:::glm_fit(X2,y2)
N=5
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,-0.1)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
N=1
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit1 = gtclust:::glm_fit(X,y)
N=1
X2= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y2=rpois(N,eta)
fit2 = gtclust:::glm_fit(X2,y2)
N=1
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,-0.1)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
y
y2
y3
N=1
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit1 = gtclust:::glm_fit(X,y)
N=1
X2= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y2=rpois(N,eta)
fit2 = gtclust:::glm_fit(X2,y2)
N=1
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(0.4,-0.1)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
y2
y3
y
N=1
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit1 = gtclust:::glm_fit(X,y)
N=1
X2= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y2=rpois(N,eta)
fit2 = gtclust:::glm_fit(X2,y2)
N=1
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(20,-0.1)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
exp(20)
N=1
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(2.5,-0.1)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
N=1
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit1 = gtclust:::glm_fit(X,y)
N=1
X2= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y2=rpois(N,eta)
fit2 = gtclust:::glm_fit(X2,y2)
N=1
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(2.5,-0.1)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
y3
N=1
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(3.5,-0.1)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
fit1
N=3
X= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y=rpois(N,eta)
fit1 = gtclust:::glm_fit(X,y)
N=3
X2= cbind(rep(1,N),seq(0,3,length=N))
a = c(1.5,0.6)
eta = exp(X%*%a)
y2=rpois(N,eta)
fit2 = gtclust:::glm_fit(X2,y2)
N=3
X3= cbind(rep(1,N),seq(0,3,length=N))
a = c(3.5,-0.1)
eta = exp(X%*%a)
y3=rpois(N,eta)
fit3 = gtclust:::glm_fit(X3,y3)
gtclust:::glm_laplace_evidence(X,y,fit1)
gtclust:::glm_laplace_evidence(X,y,fit2)
gtclust:::glm_laplace_evidence(X,y,fit3)
fit12 = gtclust:::glm_fit(rbind(X,X2),c(y,y2))
fit13 = gtclust:::glm_fit(rbind(X,X3),c(y,y3))
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
gtclust:::delta_merge_post(fit1,fit3,lambda = 0.01)
gtclust:::delta_merge_post(fit1,fit2,lambda = 0.01)
gtclust:::glm_laplace_evidence(rbind(X,X2),c(y,y2),fit12)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X2,y2,fit2))
gtclust:::glm_laplace_evidence(rbind(X,X3),c(y,y3),fit13)- (gtclust:::glm_laplace_evidence(X,y,fit1) + gtclust:::glm_laplace_evidence(X3,y3,fit3))
fit13
